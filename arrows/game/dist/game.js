!function e(t,i,s){function o(n,r){if(!i[n]){if(!t[n]){var c="function"==typeof require&&require;if(!r&&c)return c(n,!0);if(a)return a(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[n]={exports:{}};t[n][0].call(h.exports,function(e){var i=t[n][1][e];return o(i?i:e)},h,h.exports,e,t,i,s)}return i[n].exports}for(var a="function"==typeof require&&require,n=0;n<s.length;n++)o(s[n]);return o}({1:[function(e,t,i){"use strict";var s=wfl.geom,o=e("../util"),a=o.Assets,n=wfl.core.entities.GameObject,r=wfl.core.entities.PhysicsObject,c=e("./LivingObject"),l=(e("./Player"),function e(t){r.call(this),this.arrowGraphic=a.get(a.ARROW).texture,this.dealtImpactDamage=!1,this.stateBasic=n.createState(),this.frame1=n.createFrame(this.arrowGraphic),this.stateBasic.addFrame(this.frame1),this.addState(e.STATE.BASIC,this.stateBasic),this.maxSpeed=e.MAX_SPEED,this.maxAcceleration=e.MAX_ACCELERATION,this.customData.alliance=t,this.customData.DEFAULT_FRICTION=e.DEFAULT_FRICTION,this.restitution=.8});Object.defineProperties(l,{MAX_SPEED:{value:50},MAX_ACCELERATION:{value:8},MAX_DAMAGE:{value:100},KNOCKBACK_SCALAR:{value:1e3},DAMAGE_MAGNITUDE_SCALAR:{value:.5},MIN_ARROW_CHARGE_TIME:{value:200},MAX_ARROW_CHARGE_TIME:{value:500},DEFAULT_FRICTION:{value:.985},STATE:{value:{BASIC:"BASIC"}}}),l.prototype=Object.freeze(Object.create(r.prototype,{update:{value:function(e){r.prototype.update.call(this,e),this.velocity.getMagnitudeSquared()<.001&&this.stop()}},resolveCollisions:{value:function(){r.prototype.resolveCollisions.call(this),this.acceleration.multiply(0),this.velocity.multiply(0)}},onCollide:{value:function(e,t){if(e instanceof c&&!this.dealtImpactDamage){this.customData.forceRemove=!0;var i=this.velocity.clone().multiply(l.DAMAGE_MAGNITUDE_SCALAR).getMagnitudeSquared();i>l.MAX_DAMAGE&&(i=l.MAX_DAMAGE),e.takeDamage(i),e.addImpulse(this.velocity.clone().multiply(l.KNOCKBACK_SCALAR)),e.attachObject(this)}e.solid&&(r.prototype.onCollide.call(this,e,t),this.stop())}},canCollide:{value:function(e){return e.customData.alliance!==this.customData.alliance}},lookAt:{value:function(e){var t=s.Vec2.subtract(e,this.position),i=t.getAngle();this.rotate(i-this.rotation)}},stop:{value:function(){this.solid=!1,this.fixed=!0,this.dealtImpactDamage=!0}}})),Object.freeze(l),t.exports=l},{"../util":45,"./LivingObject":4,"./Player":6}],2:[function(e,t,i){"use strict";var s=wfl.geom,o=e("../util"),a=(o.Assets,wfl.core.entities.GameObject,wfl.core.entities.PhysicsObject),n=e("./LivingObject"),r=(e("./Player"),e("./Arrow")),c=function(e){r.call(this,e),this.lastHit=null,this.restitution=1,this.prevCollisions={}};Object.defineProperties(c,{STATE:{value:{BASIC:"BASIC"}},MAX_OBJECT_COLLISION_TIMER:{value:3},WALL_FRICTION:{value:.8},MIN_NORMAL_SPEED:{value:1},MIN_SPEED:{value:.01},FINAL_SLOWING_RATE:{value:.9}}),c.prototype=Object.freeze(Object.create(r.prototype,{update:{value:function(e){r.prototype.update.call(this,e);var t=Object.keys(this.prevCollisions),i=!0,o=!1,a=void 0;try{for(var n,l=t[Symbol.iterator]();!(i=(n=l.next()).done);i=!0){var h=n.value,p=this.prevCollisions[h],u=p.obj,y=p.prevPosition,d=p.prevVelocity,f=s.Vec2.subtract(u.position,this.position),v=s.Vec2.subtract(u.position,y);s.Vec2.dot(v,f)<0?(y=this.prevCollisions[h].prevPosition,d=this.prevCollisions[h].prevVelocity,this.velocity._x=-d._x,this.velocity._y=-d._y,this.position._x=y._x+2*this.velocity._x,this.position._y=y._y+2*this.velocity._y,this.rotate(this.velocity.getAngle()-this.rotation),this.collisionDisplacementSum._x=0,this.collisionDisplacementSum._y=0,this.cacheCalculations(),delete this.prevCollisions[h]):this.prevCollisions[h].collisionTimer>=c.MAX_OBJECT_COLLISION_TIMER?delete this.prevCollisions[h]:this.prevCollisions[h].collisionTimer++}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}var m=c.MIN_NORMAL_SPEED,S=c.MIN_SPEED;this.velocity.getMagnitudeSquared()<m*m&&this.velocity.multiply(c.FINAL_SLOWING_RATE),this.velocity.getMagnitudeSquared()<S*S&&(this.velocity.multiply(0),this.stop())}},resolveCollisions:{value:function(){var e=this.collisionDisplacementSum._x,t=this.collisionDisplacementSum._y;e=e<0?Math.floor(e):Math.ceil(e),t=t<0?Math.floor(t):Math.ceil(t),this.transform.position._x+=e,this.calculationCache.x+=e,this.transform.position._y+=t,this.calculationCache.y+=t}},onCollide:{value:function(e,t){var i=!1,s=this.velocity.clone(),o=this.position.clone();if(this.lastHit!==e){if(e instanceof n&&!this.dealtImpactDamage){this.customData.forceRemove=!0;var l=this.velocity.clone().multiply(r.DAMAGE_MAGNITUDE_SCALAR).getMagnitudeSquared();l>r.MAX_DAMAGE&&(l=r.MAX_DAMAGE),e.takeDamage(l),e.addImpulse(this.velocity.clone().multiply(r.KNOCKBACK_SCALAR)),e.attachObject(this),i=!0}if(e.solid&&a.prototype.onCollide.call(this,e,t),!i){var h={x:this.forward._x,y:this.forward._y};if(t.edgeDirection){var p={x:-this.forward._y,y:this.forward._x},u=this.forward._x*t.edgeDirection.x+this.forward._y*t.edgeDirection.y,y=p.x*t.edgeDirection.x+p.y*t.edgeDirection.y,d=Math.acos(u);y<0?this.rotate(-2*d):this.rotate(2*d),this.velocity.setAngle(this.rotation)}else this.rotate(Math.PI),this.velocity._x*=-1,this.velocity._y*=-1;var f=.5*this._cachedHeight;this.position._x+=h.x*f+this.forward._x*f,this.position._y+=h.y*f+this.forward._y*f,this.prevCollisions[e.wflId]?this.prevCollisions[e.wflId]={obj:e,prevPosition:this.prevCollisions[e.wflId].prevPosition,prevVelocity:this.prevCollisions[e.wflId].prevVelocity,collisionTimer:0}:this.prevCollisions[e.wflId]={obj:e,prevPosition:o,prevVelocity:s,collisionTimer:0},this.velocity.multiply(c.WALL_FRICTION)}}}}})),Object.freeze(c),t.exports=c},{"../util":45,"./Arrow":1,"./LivingObject":4,"./Player":6}],3:[function(e,t,i){"use strict";var s=wfl.geom,o=e("../util"),a=o.Assets,n=wfl.core.entities.GameObject,r=(wfl.core.entities.PhysicsObject,e("./LivingObject")),c=e("./Segment"),l=e("./Player"),h=function e(t,i){r.call(this),this.player=t,this.quadtree=i,this.enemyGraphic=a.get(a.ENEMY).texture,this.stateBasic=n.createState(),this.frame1=n.createFrame(this.enemyGraphic),this.stateBasic.addFrame(this.frame1),this.addState(e.STATE.BASIC,this.stateBasic),this.maxSpeed=e.MAX_SPEED,this.maxAcceleration=e.MAX_ACCELERATION,this.rays=[],this.mass=1};Object.defineProperties(h,{MAX_SPEED:{value:1},MAX_ACCELERATION:{value:4},SPRINT_MAX_SPEED:{value:2},SPRINT_BOOST_ACCELERATION:{value:6},BOOST_ACCELERATION:{value:.5},VIEW_LIMIT:{value:256},VIEW_SEGMENTS:{value:11},VIEW_ANGLE_LIMIT:{value:.5*Math.PI},ALLIANCE:{value:2},STATE:{value:{BASIC:"BASIC"}}}),h.prototype=Object.freeze(Object.create(r.prototype,{update:{value:function(e){r.prototype.update.call(this,e),s.Vec2.subtract(this.player.position,this.position).getMagnitude()<h.VIEW_LIMIT+20&&this._handleViewing()}},takeDamage:{value:function(e){this.health-=e}},_handleViewing:{value:function(){var e=h.VIEW_ANGLE_LIMIT/(h.VIEW_SEGMENTS-1);this.rays=[];var t=new s.Vec2.fromAngle(this.rotation-.5*h.VIEW_ANGLE_LIMIT).multiply(h.VIEW_LIMIT),i=t.clone().multiply(-.5),o=t.clone().multiply(.5),a=new c(h.VIEW_LIMIT,t.getAngle(),i,o);a.position.add(this.position),a.position.add(o),a.update(),this.rays.push(a);for(var n=1;n<h.VIEW_SEGMENTS;n++)t.rotate(e),i=t.clone().multiply(-.5),o=t.clone().multiply(.5),a=new c(h.VIEW_LIMIT,t.getAngle(),i,o),a.position.add(this.position),a.position.add(o),a.update(),this.rays.push(a);for(var r,p,u,y,d=[],f=[],v=!1,m=!1,n=0;n<this.rays.length;n++){d=[],f=[],v=!1,this.quadtree.retrieve(d,this.rays[n]);for(var S=0;S<d.length;S++)r=this.rays[n].checkCollision(d[S]),r.colliding&&(f.push(d[S]),d[S]instanceof l&&(v=!0));if(v){p=1/0,u=-1;for(var w=0;w<f.length;w++)f[w]instanceof h||(y=s.Vec2.subtract(this.position,f[w].position).getMagnitudeSquared(),y<p&&(p=y,u=w));f[u]instanceof l&&(m=!0)}v=!1}}}})),Object.freeze(h),t.exports=h},{"../util":45,"./LivingObject":4,"./Player":6,"./Segment":7}],4:[function(e,t,i){"use strict";var s=wfl.geom,o=e("../util"),a=(o.Assets,wfl.core.entities.GameObject,wfl.core.entities.PhysicsObject),n=function e(){a.call(this),this.health=e.DEFAULT_MAX_HEALTH,this.maxHealth=e.DEFAULT_MAX_HEALTH,this.friction=.2,this.restitution=.8};Object.defineProperties(n,{DEFAULT_MAX_HEALTH:{value:100}}),n.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){a.prototype.update.call(this,e)}},attachObject:{value:function(e){e.solid=!1,e.static=!0,this.addChild(e)}},lookAt:{value:function(e){var t=s.Vec2.subtract(e,this.position),i=t.getAngle();this.rotate(i-this.rotation)}}})),Object.freeze(n),t.exports=n},{"../util":45}],5:[function(e,t,i){"use strict";var s=(wfl.geom,e("../util")),o=s.Assets,a=wfl.core.entities.GameObject,n=wfl.core.entities.PhysicsObject,r=function e(){n.call(this),this.platformGraphic=o.get(o.PLATFORM).texture,this.stateBasic=a.createState(),this.frame1=a.createFrame(this.platformGraphic),this.stateBasic.addFrame(this.frame1),this.addState(e.STATE.BASIC,this.stateBasic),this.fixed=!0,this.solid=!0};Object.defineProperties(r,{STATE:{value:{BASIC:"BASIC"}}}),r.prototype=Object.freeze(Object.create(n.prototype,{})),t.exports=r},{"../util":45}],6:[function(e,t,i){"use strict";var s=wfl.geom,o=e("../util"),a=o.Assets,n=wfl.core.entities.GameObject,r=(wfl.core.entities.PhysicsObject,e("./LivingObject")),c=function e(){r.call(this),this.playerGraphic=a.get(a.PLAYER).texture,this.stateBasic=n.createState(),this.frame1=n.createFrame(this.playerGraphic),this.stateBasic.addFrame(this.frame1),this.addState(e.STATE.BASIC,this.stateBasic),this.maxSpeed=e.MAX_SPEED,this.maxAcceleration=e.MAX_ACCELERATION,this.customData.alliance=e.ALLIANCE,this._walkDirectionStack=[],this.allowVertexRotation=!1};Object.defineProperties(c,{MAX_SPEED:{value:2},MAX_ACCELERATION:{value:.5},SPRINT_MAX_SPEED:{value:4},SPRINT_BOOST_ACCELERATION:{value:1},BOOST_ACCELERATION:{value:.5},STATE:{value:{BASIC:"BASIC"}},ALLIANCE:{value:1}}),c.prototype=Object.freeze(Object.create(r.prototype,{update:{value:function(e){r.prototype.update.call(this,e)}},canCollide:{value:function(e){return e.customData.alliance!==this.customData.alliance}},lookAt:{value:function(e){var t=s.Vec2.subtract(e,this.position),i=t.getAngle();this.rotate(i-this.rotation)}},handleInput:{value:function(e){for(var t=e.isPressed(e.SHIFT),i=e.getKeyJustPressed(),o=-1,a=-1,n=-1,r=-1,l=this._walkDirectionStack.length;l>=0;l--)e.isPressed(this._walkDirectionStack[l])||this._walkDirectionStack.splice(l,1);if(i>-1)switch(i){case e.A:case e.D:case e.W:case e.S:this._walkDirectionStack.push(i)}for(var h=0,l=0;l<this._walkDirectionStack.length;l++)switch(this._walkDirectionStack[l]){case e.A:o=h,h++;break;case e.D:a=h,h++;break;case e.W:n=h,h++;break;case e.S:r=h,h++}var p;if(t?(p=c.SPRINT_BOOST_ACCELERATION,this.maxSpeed=c.SPRINT_MAX_SPEED):(p=c.BOOST_ACCELERATION,this.maxSpeed=c.MAX_SPEED),o>a){var u=new s.Vec2(-1,0);u.multiply(p*this.mass),this.addForce(u)}if(a>o){var u=new s.Vec2(1,0);u.multiply(p*this.mass),this.addForce(u)}if(n>r){var u=new s.Vec2(0,-1);u.multiply(p*this.mass),this.addForce(u)}if(r>n){var u=new s.Vec2(0,1);u.multiply(p*this.mass),this.addForce(u)}}}})),Object.freeze(c),t.exports=c},{"../util":45,"./LivingObject":4}],7:[function(e,t,i){"use strict";var s=(wfl.geom,e("../util")),o=(s.Assets,wfl.core.entities.GameObject,wfl.core.entities.PhysicsObject),a=(e("./LivingObject"),e("./Player"),e("./Enemy"),function(e,t,i,s){o.call(this),this.vertices=[],this.vertices.push(i.clone()),this.vertices.push(s.clone());var e=e,a=1,n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),c=n*e+r*a,l=n*a+r*e;this.calculationCache={x:this.position.x,y:this.position.y,width:e,height:1,aabbWidth:c,aabbHeight:l,aabbHalfWidth:.5*c,aabbHalfHeight:.5*l}});Object.defineProperties(a,{STATE:{value:{BASIC:"BASIC"}}}),a.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(){o.prototype.update.call(this,0),this.calculationCache.x=this.position.x,this.calculationCache.y=this.position.y}},resolveCollisions:{value:function(){}}})),Object.freeze(a),t.exports=a},{"../util":45,"./Enemy":3,"./LivingObject":4,"./Player":6}],8:[function(e,t,i){"use strict";var s=(wfl.geom,e("../util")),o=s.Assets,a=wfl.core.entities.GameObject,n=wfl.core.entities.PhysicsObject,r=function e(){n.call(this),this.smallBlockGraphic=o.get(o.SMALL_BLOCK).texture,this.stateBasic=a.createState(),this.frame1=a.createFrame(this.smallBlockGraphic),this.stateBasic.addFrame(this.frame1),this.addState(e.STATE.BASIC,this.stateBasic),this.solid=!0};Object.defineProperties(r,{STATE:{value:{BASIC:"BASIC"}}}),r.prototype=Object.freeze(Object.create(n.prototype,{})),t.exports=r},{"../util":45}],9:[function(e,t,i){"use strict";var s=(wfl.geom,e("../util")),o=s.Assets,a=wfl.core.entities.GameObject,n=wfl.core.entities.PhysicsObject,r=function e(){n.call(this),this.wallGraphic=o.get(o.WALL).texture,this.stateBasic=a.createState(),this.frame1=a.createFrame(this.wallGraphic),this.stateBasic.addFrame(this.frame1),this.addState(e.STATE.BASIC,this.stateBasic),this.fixed=!0,this.solid=!0,this.restitution=.8};Object.defineProperties(r,{STATE:{value:{BASIC:"BASIC"}}}),r.prototype=Object.freeze(Object.create(n.prototype,{})),Object.freeze(r),t.exports=r},{"../util":45}],10:[function(e,t,i){"use strict";var s=e("./Player.js"),o=e("./Enemy.js"),a=e("./Arrow.js"),n=e("./ArrowRicochet.js"),r=e("./Wall.js"),c=e("./LivingObject.js"),l=e("./Platform.js"),h=e("./SmallBlock.js");t.exports={LivingObject:c,Player:s,Enemy:o,Arrow:a,Wall:r,ArrowRicochet:n,Platform:l,SmallBlock:h}},{"./Arrow.js":1,"./ArrowRicochet.js":2,"./Enemy.js":3,"./LivingObject.js":4,"./Platform.js":5,"./Player.js":6,"./SmallBlock.js":8,"./Wall.js":9}],11:[function(e,t,i){"use strict";var s=(e("./util"),e("./scenes")),o=e("./util/Assets.js"),a=e("./map"),n=document.querySelector("#game-canvas"),r=wfl.create(n),c=function(){var e=r.loader;for(var t in o)try{e=e.add(o[t])}catch(e){}e.load(l),u()},l=function(){o.get=function(e){return PIXI.loader.resources[e]},wfl.jquery.getJSON(o.MAP1,h)},h=function(e){a.Room.setRooms(e.maps);var t=new s.GameScene(n,r.pixi),i=location.href.split("/"),o=i[i.length-1].split("?");if(o.length>1){var c=o[1].split("&"),l=!0,h=!1,p=void 0;try{for(var u,y=c[Symbol.iterator]();!(l=(u=y.next()).done);l=!0){var d=u.value,f=d.split("=");if(f.length>1){var v=f[0],m=f[1];"test"===v&&"true"===m?t=new s.test.TestScene1(n,r.pixi):"msg"===v&&"true"===m&&s.test.TestSceneBase.showMessages()}}}catch(e){h=!0,p=e}finally{try{!l&&y.return&&y.return()}finally{if(h)throw p}}}r.setScene(t)},p=function(e){u()},u=function(){var e=window.innerWidth,t=window.innerHeight;n.width=e,n.height=t,r.renderer.view.style.width=e+"px",r.renderer.view.style.height=t+"px",r.renderer.resize(e,t)};window.addEventListener("load",c),window.addEventListener("resize",p)},{"./map":15,"./scenes":17,"./util":45,"./util/Assets.js":42}],12:[function(e,t,i){"use strict";var s=e("../entities"),o=64;t.exports={generate:function(t){for(var i=0,s=0,o=0,a=0,n=0;n<t.length;n++){var r=t[n];"\n"===r?(s++,i=0):(o=Math.max(i,o),a=Math.max(i,a),i++)}var c=e("../map");return new c.Room(o,a,t)},addRoomToScene:function(e,t){for(var i=0,a=0,n=e.offsetTileX,r=e.offsetTileY,c=e.mapData,l=[],h=0;h<c.length;h++){var p=c[h];if("\n"===p)a++,i=0;else{var u=o*(i+n),y=o*(a+r),d=null,f=0;switch(p){case"X":d=new s.Wall;break;case"S":d=new s.Player,d.rotate(.5*Math.PI),t.player=d,t.camera.follow(d),f=3;break;case"L":l.push({x:u,y:y,rotation:Math.PI});break;case"U":l.push({x:u,y:y,rotation:1.5*Math.PI});break;case"R":l.push({x:u,y:y,rotation:0});break;case"D":l.push({x:u,y:y,rotation:.5*Math.PI})}d&&(d.position.x=u,d.position.y=y,t.addGameObject(d,f)),i++}}for(var h=0;h<l.length;h++){var v=new s.Enemy(t.player,t._quadtree);v.position.x=l[h].x,v.position.y=l[h].y,v.rotate(l[h].rotation),t.addGameObject(v,1)}},addSectorToScene:function(e,t){var i=e.spawnRoom;this.addRoomToScene(i,t);for(var s=0;s<e.roomWidth;s++)for(var o=0;o<e.roomHeight;o++){var a=e.roomLayout[s][o];a&&a!==i&&this.addRoomToScene(a,t)}}}},{"../entities":10,"../map":15}],13:[function(e,t,i){"use strict";var s=e("./MapParser"),o=null,a=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t&&"number"!=typeof t?(s=t,e.createRoom(s)):(this.tileWidth=t,this.tileHeight=i,this.offsetTileX=0,this.offsetTileY=0,void(this.mapData=s))};Object.defineProperties(a,{ROOM_TILE_WIDTH:{value:12},ROOM_TILE_HEIGHT:{value:12},setRooms:{value:function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].mapData.join("\n"));o=t}},createFrom:{value:function(e){return s.generate(e)}},createRandom:{value:function(){var e=Math.floor(o.length*Math.random()),t=o[e];return a.createFrom(t)}}}),a.prototype=Object.create(a.prototype,{setAsSpawnRoom:{value:function(){this._replaceRandomEnemyWithSpawn(),this._removeEnemies()}},_replaceRandomEnemyWithSpawn:{value:function(){for(var e=[],t=this.mapData,i=0;i<t.length;i++){var s=t[i],o="L"===s||"U"===s||"R"===s||"D"===s;o&&e.push(i)}var a=Math.floor(Math.random()*e.length),n=e[a],r=t.substr(0,n)+"S"+t.substr(n+1);this.mapData=r}},_removeEnemies:{value:function(){for(var e=this.mapData,t="",i=0;i<e.length;i++){var s=e[i],o="L"===s||"U"===s||"R"===s||"D"===s;t+=o?" ":s}this.mapData=t}}}),t.exports=a},{"./MapParser":12}],14:[function(e,t,i){"use strict";var s=e("./Room"),o=e("./MapParser"),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;("number"!=typeof e||e<1)&&(e=1),("number"!=typeof t||t<1)&&(t=1),this.roomWidth=e,this.roomHeight=t,this.roomLayout=[],this.rooms=[];for(var i=0;i<e;i++){this.roomLayout.push([]);for(var s=0;s<t;s++)this.roomLayout[i].push(null)}this._playerSet=!1};a.prototype=Object.create(a.prototype,{addRoom:{value:function(e,t,i){e instanceof s||(e=s.createRandom()),("number"!=typeof t||t<0)&&(t=Math.random()*this.roomWidth),("number"!=typeof i||i<0)&&(i=Math.random()*this.roomHeight),t=Math.floor(t),i=Math.floor(i),this.roomLayout[t][i]||(e.offsetTileX=s.ROOM_TILE_WIDTH*t,e.offsetTileY=s.ROOM_TILE_WIDTH*i,this.roomLayout[t][i]=e,this.rooms.push(e))}},addToScene:{value:function(e){this._playerSet||this._determinePlayerSpawn(),o.addSectorToScene(this,e)}},_determinePlayerSpawn:{value:function(){var e=Math.floor(Math.random()*this.rooms.length),t=this.rooms[e];t.setAsSpawnRoom(),this.spawnRoom=t,this._playerSet=!0}}}),t.exports=a},{"./MapParser":12,"./Room":13}],15:[function(e,t,i){"use strict";var s=e("./MapParser.js"),o=e("./Room.js"),a=e("./Sector.js");t.exports={MapParser:s,Room:o,Sector:a}},{"./MapParser.js":12,"./Room.js":13,"./Sector.js":14}],16:[function(e,t,i){"use strict";var s=wfl.jquery,o=wfl.display.Scene,a=wfl.geom,n=e("../entities"),r=e("../map"),c=function(e,t){o.call(this,e),this.PIXI=t,this.mouseDownTime=0,s(e).on("mousedown",this._onMouseDown.bind(this)),s(e).on("mousemove",this._onMouseMove.bind(this)),s(e).on("mouseup",this._onMouseUp.bind(this)),this.sector=new r.Sector(3,3),this.sector.addRoom(),this.sector.addRoom(),this.sector.addRoom(),this.sector.addRoom(),this.sector.addRoom(),this.sector.addToScene(this)};Object.defineProperties(c,{FRICTION:{value:.9}}),c.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){var t=!0,i=!1,s=void 0;try{for(var a,n=this._nearbyGameObjects[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var r=a.value;(r.health<=0||r.customData.forceRemove)&&this.removeGameObject(r)}}catch(e){i=!0,s=e}finally{try{!t&&n.return&&n.return()}finally{if(i)throw s}}this._handleInput(),this._applyFriction(),o.prototype.update.call(this,e)}},_handleInput:{value:function(){this.player.handleInput(this.keyboard)}},_applyFriction:{value:function(){var e=!0,t=!1,i=void 0;try{for(var s,o=this._nearbyGameObjects[Symbol.iterator]();!(e=(s=o.next()).done);e=!0){var a=s.value,n=a.customData.DEFAULT_FRICTION||c.FRICTION;a.acceleration.multiply(n),a.velocity.multiply(n)}}catch(e){t=!0,i=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw i}}}},_onMouseDown:{value:function(e){if(1===e.which){this.mouseDownTime=Date.now();this._getMouseWorldPositionFromEvent(e)}}},_onMouseUp:{value:function(e){if(1===e.which){var t=Date.now()-this.mouseDownTime,i=t<n.Arrow.MAX_ARROW_CHARGE_TIME?t:n.Arrow.MAX_ARROW_CHARGE_TIME;if(i<n.Arrow.MIN_ARROW_CHARGE_TIME)return;var s=new n.ArrowRicochet(this.player.customData.alliance);s.position.x=this.player.position.x,s.position.y=this.player.position.y,s.rotate(this.player.rotation),s.velocity.x=40*(i/1e3),s.velocity.rotate(s.rotation),this.addGameObject(s,2)}}},_onMouseMove:{value:function(e){var t=this._getMouseWorldPositionFromEvent(e);this.player.lookAt(t);var i=Date.now()-this.mouseDownTime,s=i<n.Arrow.MAX_ARROW_CHARGE_TIME?i:n.Arrow.MAX_ARROW_CHARGE_TIME,o=new n.ArrowRicochet(this.player.customData.alliance);o.position.x=this.player.position.x,o.position.y=this.player.position.y,o.rotate(this.player.rotation),o.velocity.x=40*(s/1e3),o.velocity.rotate(o.rotation),this.addGameObject(o,2)}},_getMouseWorldPositionFromEvent:{value:function(e){var t=new a.Vec2(e.offsetX,e.offsetY);return t.x-=.5*this.canvas.width,t.y-=.5*this.canvas.height,new a.Vec2(this.camera.position.x+t.x/this.camera.zoom,this.camera.position.y+t.y/this.camera.zoom)}}})),t.exports=c},{"../entities":10,"../map":15}],17:[function(e,t,i){"use strict";var s=e("./GameScene.js"),o=e("./test");t.exports={GameScene:s,test:o}},{"./GameScene.js":16,"./test":41}],18:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene2"),n=function(e){var t=this;o.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8), 1 non-static - Vertical velocity does not gain horizontal component from collision",a);var i=new s.Wall;i.restitution=0,i.friction=.8,this.addGameObject(i),this.player=new s.Player,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.y=80,this.player.velocity.y=-5,this.player.acceleration.y=-1,this.addGameObject(this.player,2),this.camera.follow(this.player),this.timeout=window.setTimeout(function(){var e=t.player.velocity;t.onTestSuccess("(Timeout) Velocity: {"+e.x+", "+e.y+"}")},500)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){o.prototype.update.call(this,e);this.player.collisionDisplacementSum;if(this.player.collisionDisplacementSum.getMagnitudeSquared()>0){var t=this.player.velocity;Math.abs(t.x)>=1e-4?(window.clearTimeout(this.timeout),this.onTestFail("Velocity: {"+t.x+", "+t.y+"}")):(window.clearTimeout(this.timeout),this.onTestSuccess("Velocity: {"+t.x+", "+t.y+"}"))}}}})),t.exports=n},{"../../entities":10,"./TestScene2":29,"./TestSceneBase":40}],19:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=e("./TestSceneBase"),n=e("./TestScene11"),r=function(e){var t=this;a.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8), 2 non-static - 2 non-statics eventually stabilize and do not overlap",n);var i=new o.Platform;i.restitution=0,i.friction=.8,this.addGameObject(i),this.blocks=[];for(var r=0;r<2;r++){var c=new o.SmallBlock;c.position.y=-500+32*r,c.velocity.y=2,c.maxSpeed=10,c.maxAcceleration=20,this.addGameObject(c),this.blocks.push(c)}this.camera.position.y=-200,this.timeout=window.setTimeout(function(){for(var e=0;e<t.blocks.length;e++)for(var i=t.blocks[e],o=i.position,a=e+1;a<t.blocks.length;a++){var n=t.blocks[a],r=n.position,c=s.Vec2.subtract(r,o).getMagnitude();if(c<23)return void t.onTestFail("(Overlapping) Distance found between 2 overlapping = "+c)}t.onTestSuccess("No objects overlapping")},3e3)};r.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){for(var t=new s.Vec2(0,3),i=0;i<this.blocks.length;i++){var o=this.blocks[i];o.addForce(t)}a.prototype.update.call(this,e)}}})),t.exports=r},{"../../entities":10,"./TestScene11":20,"./TestSceneBase":40}],20:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=e("./TestSceneBase"),n=e("./TestScene12"),r=function(e){var t=this;a.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8), 3 non-static - 1 non-static eventually stabilize on 2 non-statics and do not overlap",n);var i=new o.Platform;i.restitution=0,i.friction=.8,this.addGameObject(i),this.blocks=[];var r=new o.SmallBlock;r.position.x=-12.1,r.position.y=-200,r.velocity.y=2,r.maxSpeed=10,r.maxAcceleration=20,this.addGameObject(r),this.blocks.push(r);var c=new o.SmallBlock;c.position.x=12.1,c.position.y=-200,c.velocity.y=2,c.maxSpeed=10,c.maxAcceleration=20,this.addGameObject(c),this.blocks.push(c);var l=new o.SmallBlock;l.position.y=-250,l.velocity.y=2,l.maxSpeed=10,l.maxAcceleration=20,this.addGameObject(l),this.blocks.push(l),this.camera.position.y=-200,this.timeout=window.setTimeout(function(){for(var e=0;e<t.blocks.length;e++)for(var i=t.blocks[e],o=i.position,a=e+1;a<t.blocks.length;a++){var n=t.blocks[a],c=n.position,h=s.Vec2.subtract(c,o).getMagnitude();if(h<23)return void t.onTestFail("(Overlapping) Distance found between 2 overlapping = "+h);if(h>35)return void t.onTestFail("(Separated) Distance found between 2 overlapping = "+h)}l.position.y<r.position.y-2?t.onTestSuccess("No objects overlapping & stabilized"):t.onTestFail("No objects overlapping, but did not resolve collision correctly")},3e3)};r.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){for(var t=new s.Vec2(0,3),i=0;i<this.blocks.length;i++){var o=this.blocks[i];o.addForce(t)}a.prototype.update.call(this,e)}}})),t.exports=r},{"../../entities":10,"./TestScene12":21,"./TestSceneBase":40}],21:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=e("./TestSceneBase"),n=e("./TestScene13"),r=function(e){var t=this;a.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8), 10 non-static - Non-static eventually stabilize and do not overlap",n);var i=new o.Platform;i.restitution=0,i.friction=.8,this.addGameObject(i),this.blocks=[];for(var r=0;r<10;r++){var c=new o.SmallBlock;c.position.y=-500+32*r,c.velocity.y=2,c.maxSpeed=10,c.maxAcceleration=20,this.addGameObject(c),this.blocks.push(c)}this.camera.position.y=-200,this.timeout=window.setTimeout(function(){for(var e=0;e<t.blocks.length;e++)for(var i=t.blocks[e],o=i.position,a=e+1;a<t.blocks.length;a++){var n=t.blocks[a],r=n.position,c=s.Vec2.subtract(r,o).getMagnitude();if(c<23)return void t.onTestFail("(Overlapping) Distance found between 2 overlapping = "+c)}t.onTestSuccess("No objects overlapping")},3e3)};r.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){for(var t=new s.Vec2(0,3),i=0;i<this.blocks.length;i++){var o=this.blocks[i];o.addForce(t)}a.prototype.update.call(this,e)}}})),t.exports=r},{"../../entities":10,"./TestScene13":22,"./TestSceneBase":40}],22:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=e("./TestSceneBase"),n=e("./TestScene14"),r=function(e){var t=this;a.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8), 6 non-static - Non-statics eventually stabilize on other non-statics and do not overlap",n);var i=new o.Platform;i.restitution=0,i.friction=.8,this.addGameObject(i),this.blocks=[];var r=new o.SmallBlock;r.position.x=-12.1,r.position.y=-200,r.velocity.y=2,r.maxSpeed=10,r.maxAcceleration=20,this.addGameObject(r),this.blocks.push(r);var c=new o.SmallBlock;c.position.x=12.1,c.position.y=-200,c.velocity.y=2,c.maxSpeed=10,c.maxAcceleration=20,this.addGameObject(c),this.blocks.push(c);var l=new o.SmallBlock;l.position.x=36.2,l.position.y=-200,l.velocity.y=2,l.maxSpeed=10,l.maxAcceleration=20,this.addGameObject(l),this.blocks.push(l);var h=new o.SmallBlock;h.position.y=-250,h.velocity.y=2,h.maxSpeed=10,h.maxAcceleration=20,this.addGameObject(h),this.blocks.push(h);var p=new o.SmallBlock;p.position.x=24.1,p.position.y=-250,p.velocity.y=2,p.maxSpeed=10,p.maxAcceleration=20,this.addGameObject(p),this.blocks.push(p);var u=new o.SmallBlock;u.position.x=12,u.position.y=-300,u.velocity.y=2,u.maxSpeed=10,u.maxAcceleration=20,this.addGameObject(u),this.blocks.push(u),this.camera.position.y=-200,this.timeout=window.setTimeout(function(){for(var e=0;e<t.blocks.length;e++)for(var i=t.blocks[e],o=i.position,a=e+1;a<t.blocks.length;a++){var n=t.blocks[a],y=n.position,d=s.Vec2.subtract(y,o).getMagnitude();if(d<23)return void t.onTestFail("(Overlapping) Distance found between 2 overlapping = "+d)}var f=(h.position.y+p.position.y)/2,v=u.position.y,m=(r.position.y+c.position.y+l.position.y)/3,S=Math.abs(m-r.position.y),w=Math.abs(m-c.position.y),T=Math.abs(m-l.position.y),b=Math.abs(f-h.position.y),x=Math.abs(f-p.position.y),g=Math.abs(v-u.position.y),O=Math.abs(-12.1-r.position.x),j=Math.abs(12.1-c.position.x),A=Math.abs(36.3-l.position.x),_=Math.abs(0-h.position.x),M=Math.abs(24.1-p.position.x),I=Math.abs(12-u.position.x),E=1.5,C=S>E||w>E||T>E||b>E||x>E||g>E||O>E||j>E||A>E||_>E||M>E||I>E;C?t.onTestFail("Objects destabilized"):t.onTestSuccess("No objects overlapping")},3e3)};r.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){for(var t=new s.Vec2(0,3),i=0;i<this.blocks.length;i++){var o=this.blocks[i];o.addForce(t)}a.prototype.update.call(this,e)}}})),t.exports=r},{"../../entities":10,"./TestScene14":23,"./TestSceneBase":40}],23:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene15"),n=function(e){var t=this;o.call(this,e,"Collision: 2 non-static (rest=0.0, mass=100.0 & 100.0) - 2 objects of equal mass and NO restitution do NOT reflect off each other",a),this.blocks=[];var i=new s.SmallBlock;i.mass=100,i.position.x=-60,i.position.y=-100,i.velocity.x=10,i.velocity.y=-10,i.acceleration.x=1,i.maxSpeed=10,i.maxAcceleration=20,this.addGameObject(i),this.blocks.push(i);var n=new s.SmallBlock;n.mass=100,n.position.x=60,n.position.y=-110,n.velocity.x=-10,n.velocity.y=-10,n.acceleration.x=-1,n.maxSpeed=10,n.maxAcceleration=20,this.addGameObject(n),this.blocks.push(n),this.timeout=window.setTimeout(function(){var e=i.velocity,s=n.velocity,o=Math.abs(e.x),a=Math.abs(s.x),r=.001;o>r||a>r?t.onTestFail("Objects bounced"):t.onTestSuccess("Objects did not bounce")},350)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){for(var t=0;t<this.blocks.length;t++){var i=this.blocks[t];i.acceleration.y=1}o.prototype.update.call(this,e)}}})),t.exports=n},{"../../entities":10,"./TestScene15":24,"./TestSceneBase":40}],24:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene16"),n=function(e){var t=this;o.call(this,e,"Collision: 2 non-static (rest=1.0, mass=100.0 & 100.0) - 2 objects of equal mass and restitution DO reflect off each other",a),this.blocks=[];var i=new s.SmallBlock;i.mass=100,i.restitution=1,i.position.x=-60,i.position.y=-100,i.velocity.x=10,i.velocity.y=-10,i.acceleration.x=1,i.maxSpeed=10,i.maxAcceleration=20,this.addGameObject(i),this.blocks.push(i);var n=new s.SmallBlock;n.mass=100,n.restitution=1,n.position.x=60,n.position.y=-110,n.velocity.x=-10,n.velocity.y=-10,n.acceleration.x=-1,n.maxSpeed=10,n.maxAcceleration=20,this.addGameObject(n),this.blocks.push(n),this.timeout=window.setTimeout(function(){var e=i.velocity,s=n.velocity,o=Math.abs(e.x),a=Math.abs(s.x),r=o-a,c=.001;o>c||a>c?r>c?t.onTestFail("Objects bounced with different speeds: "+e.x+" & "+s.x):t.onTestSuccess("Objects bounced with equal speeds: "+e.x+" & "+s.x):t.onTestFail("Objects did not bounce")},350)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){for(var t=0;t<this.blocks.length;t++){var i=this.blocks[t];i.acceleration.y=1}o.prototype.update.call(this,e)}}})),t.exports=n},{"../../entities":10,"./TestScene16":25,"./TestSceneBase":40}],25:[function(e,t,i){"use strict";var s=(wfl.jquery,
wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene17"),n=function(e){var t=this;o.call(this,e,"Collision: 2 non-static (rest=1.0, mass=1.0 & 1000.0) - 2 objects of different mass and restitution DO reflect off each other -- Heavier moves less",a),this.blocks=[];var i=new s.SmallBlock;i.mass=1,i.restitution=1,i.position.x=-60,i.position.y=-100,i.velocity.x=10,i.velocity.y=-10,i.acceleration.x=1,i.maxSpeed=10,i.maxAcceleration=20,this.addGameObject(i),this.blocks.push(i);var n=new s.SmallBlock;n.mass=1e3,n.restitution=1,n.position.x=60,n.position.y=-110,n.velocity.x=-10,n.velocity.y=-10,n.acceleration.x=-1,n.maxSpeed=10,n.maxAcceleration=20,this.addGameObject(n),this.blocks.push(n),this.timeout=window.setTimeout(function(){var e=i.velocity,s=n.velocity,o=Math.abs(e.x),a=Math.abs(s.x),r=o-a,c=.001;o>c||a>c?r>c?e.x*s.x<0?t.onTestFail("Objects bounced with different speeds in opposite directions: "+e.x+" & "+s.x):t.onTestSuccess("Objects bounced with different speeds in the same direction: "+e.x+" & "+s.x):t.onTestFail("Objects bounced with equal speeds: "+e.x+" & "+s.x):t.onTestFail("Objects did not bounce")},300)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){for(var t=0;t<this.blocks.length;t++){var i=this.blocks[t];i.acceleration.y=1}o.prototype.update.call(this,e)}}})),t.exports=n},{"../../entities":10,"./TestScene17":26,"./TestSceneBase":40}],26:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=e("./TestSceneBase"),n=e("./TestScene18"),r=function(e){var t=this;a.call(this,e,"Collision: 1 static (rest=0.0, fric=0.0, rotation=PI/6), 1 non-static - Non-static slides down angled, static object",n),this.platform=new o.Platform,this.platform.rotate(Math.PI/6),this.platform.friction=0,this.platform.restitution=0,this.addGameObject(this.platform),this.blocks=[],this.storeHistory=!1;var i=this,r=function(){o.SmallBlock.call(this)};r.prototype=Object.create(o.SmallBlock.prototype,{onCollide:{value:function(e){i.storeHistory=!0}}}),this.block0=new r,this.block0.rotate(Math.PI/6),this.block0.position.y=-200,this.block0.velocity.y=2,this.block0.maxSpeed=10,this.block0.maxAcceleration=20,this.blocks.push(this.block0),this.addGameObject(this.block0),this.prevPosition=new s.Vec2,this.displacementHistory=[],this.timeout=window.setTimeout(function(){for(var e=0,i=0;i<t.displacementHistory.length;i++)e+=t.displacementHistory[i].getAngle();t.displacementHistory.length>0&&(e/=t.displacementHistory.length);var s=.1,o=Math.PI/6;e+s>o&&e-s<o?t.onTestSuccess("Object's displacement angle ("+e+") is close to platform's rotation ("+Math.PI/6+")"):t.onTestFail("Object's displacement angle ("+e+") is not close to platform's rotation ("+Math.PI/6+")")},1e3)};r.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){for(var t=0;t<this.blocks.length;t++){var i=this.blocks[t];i.acceleration.y=1}if(this.prevPosition=this.block0.position.clone(),a.prototype.update.call(this,e),this.storeHistory){var o=s.Vec2.subtract(this.block0.position,this.prevPosition);this.displacementHistory.push(o)}}}})),t.exports=r},{"../../entities":10,"./TestScene18":27,"./TestSceneBase":40}],27:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene19"),n=function(e){var t=this;o.call(this,e,"Collision: 1 static (rest=1.0, fric=0.8), 1 non-static (rotation=-PI/4) - Non-static ricochets (from -PI/4 to 3*PI/4)",a);var i=new s.Wall;i.restitution=1,i.friction=.8,this.addGameObject(i),this.arrow=new s.ArrowRicochet,this.arrow.customData.alliance=0,this.arrow.maxSpeed=10,this.arrow.position.x=-70,this.arrow.position.y=-30,this.arrow.rotate(.25*Math.PI);var n=this.arrow.forward.clone();this.arrow.velocity._x=10*n._x,this.arrow.velocity._y=10*n._y,this.addGameObject(this.arrow,2),this.timeout=window.setTimeout(function(){var e=t.arrow.forward,i=e.getAngle(),s=.01,o=3*Math.PI/4;i-s<=o&&i+s>=o?t.onTestSuccess("(Timeout) Ricochet angle expected: "+o+", Got: "+i):t.onTestFail("(Timeout) Ricochet angle expected: "+o+", Got: "+i)},1e3)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){o.prototype.update.call(this,e)}}})),t.exports=n},{"../../entities":10,"./TestScene19":28,"./TestSceneBase":40}],28:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene20"),n=function(e){var t=this;o.call(this,e,"Collision: 1 static (rest=1.0, fric=0.8), 1 non-static (rotation=-PI/3) - Non-static ricochets (from -PI/3 to 2*PI/3)",a);var i=new s.Wall;i.restitution=1,i.friction=.8,this.addGameObject(i),this.arrow=new s.ArrowRicochet,this.arrow.customData.alliance=0,this.arrow.maxSpeed=15,this.arrow.position.x=-70,this.arrow.position.y=-40,this.arrow.rotate(Math.PI/3);var n=this.arrow.forward.clone();this.arrow.velocity._x=15*n._x,this.arrow.velocity._y=15*n._y,this.addGameObject(this.arrow,2),this.timeout=window.setTimeout(function(){var e=t.arrow.forward,i=e.getAngle(),s=.01,o=2*Math.PI/3;i-s<=o&&i+s>=o?t.onTestSuccess("(Timeout) Ricochet angle expected: "+o+", Got: "+i):t.onTestFail("(Timeout) Ricochet angle expected: "+o+", Got: "+i)},1e3)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){o.prototype.update.call(this,e)}}})),t.exports=n},{"../../entities":10,"./TestScene20":30,"./TestSceneBase":40}],29:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene3"),n=function(e){var t=this;o.call(this,e,"Collision: 2 static (rest=0.0, fric=0.8), 1 non-static - Vertical velocity does not gain horizontal component from collision",a);var i=new s.Wall;i.restitution=0,i.friction=.8,i.position.x=-32,this.addGameObject(i);var i=new s.Wall;i.restitution=0,i.friction=.8,i.position.x=32,this.addGameObject(i),this.player=new s.Player,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.y=80,this.player.velocity.y=-5,this.player.acceleration.y=-1,this.addGameObject(this.player,2),this.camera.follow(this.player),this.timeout=window.setTimeout(function(){var e=t.player.velocity;t.onTestSuccess("(Timeout) Velocity: {"+e.x+", "+e.y+"}")},500)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){o.prototype.update.call(this,e);this.player.collisionDisplacementSum;if(this.player.collisionDisplacementSum.getMagnitudeSquared()>0){var t=this.player.velocity;Math.abs(t.x)>=1e-4?(window.clearTimeout(this.timeout),this.onTestFail("Velocity: {"+t.x+", "+t.y+"}")):(window.clearTimeout(this.timeout),this.onTestSuccess("Velocity: {"+t.x+", "+t.y+"}"))}}}})),t.exports=n},{"../../entities":10,"./TestScene3":33,"./TestSceneBase":40}],30:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=s.Player,a=s.Enemy,n=e("../../util"),r=n.Steer,c=e("./TestSceneBase"),l=e("./TestScene21"),h=function(e){var t=this;c.call(this,e,"Steering force: Basic enemy seek implementation towards player.",l),this.player=new o,this.enemy=new a(this.player,this._quadtree),this.enemy.maxSpeed=5,this.enemy.maxAcceleration=1,this.enemy.rotate(-Math.PI),this.player.position.x=300,this.enemy.position.y=200,this.enemy.velocity.y=-5,this.addGameObject(this.player),this.addGameObject(this.enemy),this.timeout=window.setTimeout(function(){0!==t.enemy.position.x&&200!==t.enemy.position.y?t.onTestSuccess("Enemy sought player."):t.onTestFail("Enemy did not seek player/did not move.")},2e3)};h.prototype=Object.freeze(Object.create(c.prototype,{update:{value:function(e){var t=.1,i=r.seek(this.enemy,this.player);i.multiply(t),this.enemy.addForce(i),c.prototype.update.call(this,e)}}})),t.exports=h},{"../../entities":10,"../../util":45,"./TestScene21":31,"./TestSceneBase":40}],31:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=s.ArrowRicochet,a=s.Wall,n=e("./TestSceneBase"),r=e("./TestScene22"),c=function(e){var t=this;n.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8), 1 non-static - Collision against multiple edges should resolve with the correct edge",r),this.wall=new a,this.wall.restitution=0,this.wall.friction=.8,this.wall2=new a,this.wall2.restitution=0,this.wall2.friction=.8,this.wall2.position.x=64,this.arrow=new o,this.arrow.customData.alliance=0,this.arrow.maxSpeed=15,this.arrow.position.x=33,this.arrow.position.y=100,this.arrow.rotate(.5*-Math.PI),this.arrow.velocity.y=-15;this.arrow.position.clone();this.addGameObject(this.wall),this.addGameObject(this.wall2),this.addGameObject(this.arrow),this.timeout=window.setTimeout(function(){t.arrow.position.y>t.wall.y&&t.arrow.velocity.y>0?t.onTestSuccess("Reflected properly"):t.onTestFail("Failed to reflect")},500)};c.prototype=Object.freeze(Object.create(n.prototype,{update:{value:function(e){n.prototype.update.call(this,e)}}})),t.exports=c},{"../../entities":10,"./TestScene22":32,"./TestSceneBase":40}],32:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=o.ArrowRicochet,n=o.Wall,r=e("./TestSceneBase"),c=function(e){var t=this;r.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8), 1 non-static (rotation=PI/4) - Collision against multiple edges should resolve with the correct edge"),this.wall=new n,this.wall.restitution=0,this.wall.friction=.8,this.wall2=new n,this.wall2.restitution=0,this.wall2.friction=.8,this.wall2.position.x=64;for(var i=[],o=new s.Vec2(-29.5,96),c=0;c<9;c++){var l=new a;l.customData.alliance=0,l.maxSpeed=15,l.rotate(.2499*-Math.PI),l.position.x=o.x+.25*c,l.position.y=o.y,l.velocity=l.forward.clone().multiply(15),i.push(l),this.addGameObject(l)}this.addGameObject(this.wall),this.addGameObject(this.wall2),this.timeout=window.setTimeout(function(){var e=!0,s=!0,a=!1,n=void 0;try{for(var r,c=i[Symbol.iterator]();!(s=(r=c.next()).done);s=!0){var l=r.value;if(!(l.position.y>t.wall.y&&l.velocity.y>-1e-4&&l.position.x>o.x&&l.velocity.x>-1e-4)){e=!1;break}}}catch(e){a=!0,n=e}finally{try{!s&&c.return&&c.return()}finally{if(a)throw n}}e?t.onTestSuccess("Reflected properly"):t.onTestFail("Reflected against wrong edge")},300)};c.prototype=Object.freeze(Object.create(r.prototype,{update:{value:function(e){r.prototype.update.call(this,e)}}})),t.exports=c},{"../../entities":10,"./TestSceneBase":40}],33:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=e("./TestSceneBase"),n=e("./TestScene4"),r=function(e){var t=this;a.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8), 1 non-static - Up-right velocity, never goes left or down",n);var i=new o.Wall;i.restitution=0,i.friction=.8,this.addGameObject(i),this.player=new o.Player,this.player.restitution=0,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.x=-10,this.player.position.y=80,this.player.velocity.x=2,this.player.velocity.y=-2,this.player.acceleration.x=1,this.player.acceleration.y=-1,this.addGameObject(this.player,2),this.camera.follow(this.player),this.velocityHistory=[],this.timeout=window.setTimeout(function(){for(var e=new s.Vec2(1,0),i=new s.Vec2(0,1),o=1/0,a=t.velocityHistory[0],n=-(1/0),r=t.velocityHistory[0],c=0;c<t.velocityHistory.length;c++){var l=t.velocityHistory[c],h=s.Vec2.dot(l,e),p=s.Vec2.dot(l,i);h<o&&(a=l,o=h),p>n&&(r=l,n=p)}t.onTestSuccess("(Timeout)\n\tLeft Most: {"+a.x+", "+a.y+"}\n\tDown Most: {"+r.x+", "+r.y+"}")},1e3)};r.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){a.prototype.update.call(this,e);var t=this.player.velocity;(t.x<-1e-4||t.y>1e-4)&&(window.clearTimeout(this.timeout),this.onTestFail("Velocity: {"+t.x+", "+t.y+"}")),this.velocityHistory.push(this.player.velocity.clone())}}})),t.exports=r},{"../../entities":10,"./TestScene4":34,"./TestSceneBase":40}],34:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene5"),n=function(e){var t=this;o.call(this,e,"Collision: 1 static (rest=1.0, fric=0.8), 1 non-static - Up-right velocity, should bounce and deflect down",a);var i=new s.Wall;i.restitution=1,i.friction=.8,this.addGameObject(i),this.player=new s.Player,this.player.restitution=1,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.x=-40,this.player.position.y=70,this.player.velocity.x=2,this.player.velocity.y=-5,this.player.acceleration.x=1,this.player.acceleration.y=-1,this.addGameObject(this.player,2),this.camera.follow(this.player),this.timeout=window.setTimeout(function(){t.onTestFail("(Timeout) Never bounced")},1500)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){o.prototype.update.call(this,e);var t=this.player.velocity;t.y>=.001&&(window.clearTimeout(this.timeout),this.onTestSuccess("Velocity: {"+t.x+", "+t.y+"}"))}}})),t.exports=n},{"../../entities":10,"./TestScene5":35,"./TestSceneBase":40}],35:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene6"),n=function(e){var t=this;o.call(this,e,"Collision: 2 static (rest=0.0, fric=0.0 & 1.0), 1 non-static - Up-right velocity, should be reduced from friction by 2nd static",a);var i=new s.Wall;i.position.x=-32,i.restitution=0,i.friction=0,this.addGameObject(i);var i=new s.Wall;i.position.x=32,i.restitution=0,i.friction=1,this.addGameObject(i),this.player=new s.Player,this.player.friction=0,this.player.restitution=0,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.x=-64,this.player.position.y=48,this.player.velocity.x=2,this.player.velocity.y=-5,this.player.acceleration.x=1,this.player.acceleration.y=-1,this.addGameObject(this.player,2),this.camera.follow(this.player),this.velocityHistoryFirstHalf=[],this.velocityHistorySecondHalf=[],this.timeout=window.setTimeout(function(){t.onTestFail("(Timeout) Never reduced speed")},2e3)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){if(this.player.acceleration.x=1,this.player.acceleration.y=-1,o.prototype.update.call(this,e),this.player.position.x>=64){for(var t=0,i=0,s=0,a=0,n=0;n<this.velocityHistoryFirstHalf.length;n++){var r=this.velocityHistoryFirstHalf[n];t+=r.getMagnitude()}for(var n=0;n<this.velocityHistorySecondHalf.length;n++){var r=this.velocityHistorySecondHalf[n];s+=r.getMagnitude()}i=t/this.velocityHistoryFirstHalf.length,a=s/this.velocityHistorySecondHalf.length,window.clearTimeout(this.timeout),a<i?this.onTestSuccess("Reduced speed: First half = "+i+", Second half = "+a):this.onTestFail("Never reduced speed: First half = "+i+", Second half = "+a)}else this.player.position.x<0?this.velocityHistoryFirstHalf.push(this.player.velocity.clone()):this.velocityHistorySecondHalf.push(this.player.velocity.clone())}}})),t.exports=n},{"../../entities":10,"./TestScene6":36,"./TestSceneBase":40}],36:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene7"),n=function(e){var t=this;o.call(this,e,"Collision: 3 static (rest=0.0, fric=0.0), 1 non-static - Up-right velocity, should NOT be reduced from friction by 2nd or 3rd static",a);var i=new s.Wall;i.position.x=-32,i.restitution=0,i.friction=0,this.addGameObject(i);var i=new s.Wall;i.position.x=32,i.restitution=0,i.friction=0,this.addGameObject(i);var i=new s.Wall;i.position.x=96,i.restitution=0,i.friction=0,this.addGameObject(i),this.player=new s.Player,this.player.friction=0,this.player.restitution=0,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.x=-64,this.player.position.y=48,this.player.velocity.x=5,this.player.velocity.y=-5,this.player.acceleration.x=1,this.player.acceleration.y=-1,this.addGameObject(this.player,2),this.camera.follow(this.player),this.velocityHistoryFirst=[],this.velocityHistorySecond=[],this.velocityHistoryThird=[],this.timeout=window.setTimeout(function(){t.onTestFail("(Timeout) Inconclusive")},3e3)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){if(this.player.acceleration.x=1,this.player.acceleration.y=-1,o.prototype.update.call(this,e),this.player.position.x>=128){for(var t=0,i=0,s=0,a=0,n=0,r=0,c=0;c<this.velocityHistoryFirst.length;c++){var l=this.velocityHistoryFirst[c];t+=l.getMagnitude()}for(var c=0;c<this.velocityHistorySecond.length;c++){var l=this.velocityHistorySecond[c];s+=l.getMagnitude()}for(var c=0;c<this.velocityHistoryThird.length;c++){var l=this.velocityHistoryThird[c];n+=l.getMagnitude()}i=t/this.velocityHistoryFirst.length,a=s/this.velocityHistorySecond.length,r=n/this.velocityHistoryThird.length;var h=a-i,p=r-a,u=(h+p)/2;window.clearTimeout(this.timeout);var y=.1;Math.abs(u)>=y?this.onTestFail("Reduced speed: "+i+" "+a+" "+r):this.onTestSuccess("Never reduced speed")}else this.player.position.x<0?this.velocityHistoryFirst.push(this.player.velocity.clone()):this.player.position.x<64?this.velocityHistorySecond.push(this.player.velocity.clone()):this.velocityHistoryThird.push(this.player.velocity.clone())}}})),t.exports=n},{"../../entities":10,"./TestScene7":37,"./TestSceneBase":40}],37:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom,e("../../entities")),o=e("./TestSceneBase"),a=e("./TestScene8"),n=function(e){var t=this;o.call(this,e,"Collision: 3 static (rest=0.0, fric=0.0), 1 non-static - Up-right velocity, position should always be moving right (and usually up)",a);var i=new s.Wall;i.position.x=-32,i.restitution=0,i.friction=0,this.addGameObject(i);var i=new s.Wall;i.position.x=32,i.restitution=0,i.friction=0,this.addGameObject(i);var i=new s.Wall;i.position.x=96,i.restitution=0,i.friction=0,this.addGameObject(i),this.player=new s.Player,this.player.friction=0,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.x=-64,this.player.position.y=48,this.player.velocity.x=2,this.player.velocity.y=-5,this.player.acceleration.x=1,this.player.acceleration.y=-1,this.addGameObject(this.player,2),this.camera.follow(this.player),this.prevSpeed=0,this.timeout=window.setTimeout(function(){t.onTestSuccess("Never pushed left or down")},1e3)};n.prototype=Object.freeze(Object.create(o.prototype,{update:{value:function(e){var t=this.player.position.clone();this.player.acceleration.x=1,this.player.acceleration.y=-1,o.prototype.update.call(this,e);var i=this.player.position.clone(),s=i.subtract(t),a=3;(s.x<=-a||s.y>=a)&&(window.clearTimeout(this.timeout),this.onTestFail("Displacement: {"+s.x+", "+s.y+"}"))}}})),t.exports=n},{"../../entities":10,"./TestScene8":38,"./TestSceneBase":40}],38:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=e("./TestSceneBase"),n=e("./TestScene9"),r=function(e){var t=this;a.call(this,e,"Collision: 1 static (rest=0.0, fric=0.8, rotation=PI/4), 1 non-static - Can move along angled edges",n);var i=new o.Wall;i.restitution=0,i.friction=.8,i.position.x=-32,i.rotate(.25*Math.PI),this.addGameObject(i),this.player=new o.Player,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.y=80,this.player.velocity.y=-5,this.player.acceleration.y=-5,this.addGameObject(this.player,2),this.camera.follow(this.player),this.velocityHistory=[],this.timeout=window.setTimeout(function(){window.clearTimeout(t.timeout);for(var e=new s.Vec2(1,0),i=new s.Vec2(0,1),o=1/0,a=t.velocityHistory[0],n=-(1/0),r=t.velocityHistory[0],c=0;c<t.velocityHistory.length;c++){var l=t.velocityHistory[c],h=s.Vec2.dot(l,e),p=s.Vec2.dot(l,i);h<o&&(a=l,o=h),p>n&&(r=l,n=p)}t.onTestSuccess("Left Most: {"+a.x+", "+a.y+"}\n\tDown Most: {"+r.x+", "+r.y+"}")},500)};r.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){this.player.acceleration.y=-1,a.prototype.update.call(this,e);var t=this.player.velocity;(t.x<0||t.y>=1e-4)&&(window.clearTimeout(this.timeout),this.onTestFail("Velocity: {"+t.x+", "+t.y+"}")),this.velocityHistory.push(this.player.velocity.clone())}}})),t.exports=r},{"../../entities":10,"./TestScene9":39,"./TestSceneBase":40}],39:[function(e,t,i){"use strict";var s=(wfl.jquery,wfl.display.Scene,wfl.geom),o=e("../../entities"),a=e("./TestSceneBase"),n=e("./TestScene10"),r=function(e){var t=this;a.call(this,e,"Collision: 3 static (rest=0.0, fric=0.8, rotation=PI/4), 1 non-static - Can move along adjacent angled edges",n);for(var i=.25*Math.PI,r=0;r<3;r++){var c=64*r,l=c*Math.cos(i),h=-c*Math.sin(i),p=new o.Wall;p.restitution=0,p.friction=.8,p.position.x=l,p.position.y=h,p.rotate(i),this.addGameObject(p)}this.player=new o.Player,this.player.maxSpeed=5,this.player.maxAcceleration=10,this.player.position.x=25,this.player.position.y=70,this.player.velocity.y=-5,this.addGameObject(this.player,2),this.camera.follow(this.player),this.velocityHistory=[],this.timeout=window.setTimeout(function(){for(var e=new s.Vec2(1,0),i=new s.Vec2(0,1),o=1/0,a=t.velocityHistory[0],n=-(1/0),r=t.velocityHistory[0],c=0;c<t.velocityHistory.length;c++){var l=t.velocityHistory[c],h=s.Vec2.dot(l,e),p=s.Vec2.dot(l,i);h<o&&(a=l,o=h),p>n&&(r=l,n=p)}t.onTestSuccess("Left Most: {"+a.x+", "+a.y+"}\n\tDown Most: {"+r.x+", "+r.y+"}")},1600)};r.prototype=Object.freeze(Object.create(a.prototype,{update:{value:function(e){this.player.acceleration.y=-1,a.prototype.update.call(this,e);this.player.collisionDisplacementSum;if(this.player.collisionDisplacementSum.getMagnitudeSquared()>0){var t=this.player.velocity;(t.x<0||t.y>=1e-4)&&(window.clearTimeout(this.timeout),this.onTestFail("Velocity: {"+t.x+", "+t.y+"}"))}this.velocityHistory.push(this.player.velocity.clone())}}})),t.exports=r},{"../../entities":10,"./TestScene10":19,"./TestSceneBase":40}],40:[function(e,t,i){"use strict";var s=wfl.display.Scene,o=e("../GameScene"),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NO NAME ENTERED FOR TEST",i=arguments[2];s.call(this,e),this.name="<"+t+">",this._upcomingScene=i};Object.defineProperties(a,{FRICTION:{value:.9},hideMessages:{value:function(){a._messageIsVisible=!1}},showMessages:{value:function(){a._messageIsVisible=!0}},_messageIsVisible:{value:!0,writable:!0}}),a.prototype=Object.freeze(Object.create(s.prototype,{update:{value:function(e){for(var t=this.getGameObjects(),i=0;i<t.length;i++)t[i].health<=0?this.removeGameObject(t[i]):t[i].customData.forceRemove&&this.removeGameObject(t[i]);this._applyFriction(),s.prototype.update.call(this,e)}},onTestSuccess:{value:function(e){console.log("%cPassed: "+this.name,"color: green;"),a._messageIsVisible&&e&&console.log("\t"+e),this._upcomingScene||(this._upcomingScene=o),this.change(new this._upcomingScene(this.canvas))}},onTestFail:{value:function(e){console.log("%cFailed: "+this.name,"color: red;"),a._messageIsVisible&&e&&console.log("\t"+e),this._upcomingScene||(this._upcomingScene=o),this.change(new this._upcomingScene(this.canvas))}},_applyFriction:{value:function(){for(var e=this.getGameObjects(),t=0;t<e.length;t++)e[t].acceleration.multiply(a.FRICTION),e[t].velocity.multiply(a.FRICTION)}}})),t.exports=a},{"../GameScene":16}],41:[function(e,t,i){"use strict";var s=e("./TestSceneBase"),o=e("./TestScene1"),a=e("./TestScene2"),n=e("./TestScene3"),r=e("./TestScene4"),c=e("./TestScene5"),l=e("./TestScene6"),h=e("./TestScene7"),p=e("./TestScene8"),u=e("./TestScene9"),y=e("./TestScene10"),d=e("./TestScene11"),f=e("./TestScene12"),v=e("./TestScene13"),m=e("./TestScene14"),S=e("./TestScene15"),w=e("./TestScene16"),T=e("./TestScene17"),b=e("./TestScene18"),x=e("./TestScene19"),g=e("./TestScene20"),O=e("./TestScene21"),j=e("./TestScene22");t.exports={TestSceneBase:s,TestScene1:o,TestScene2:a,TestScene3:n,TestScene4:r,TestScene5:c,TestScene6:l,TestScene7:h,TestScene8:p,TestScene9:u,TestScene10:y,TestScene11:d,TestScene12:f,TestScene13:v,TestScene14:m,TestScene15:S,TestScene16:w,TestScene17:T,TestScene18:b,TestScene19:x,TestScene20:g,TestScene21:O,TestScene22:j}},{"./TestScene1":18,"./TestScene10":19,"./TestScene11":20,"./TestScene12":21,"./TestScene13":22,"./TestScene14":23,"./TestScene15":24,"./TestScene16":25,"./TestScene17":26,"./TestScene18":27,"./TestScene19":28,"./TestScene2":29,"./TestScene20":30,"./TestScene21":31,"./TestScene22":32,"./TestScene3":33,"./TestScene4":34,"./TestScene5":35,"./TestScene6":36,"./TestScene7":37,"./TestScene8":38,"./TestScene9":39,"./TestSceneBase":40}],42:[function(e,t,i){"use strict";t.exports={PLAYER:"./assets/img/player.png",ENEMY:"./assets/img/enemy.png",ARROW:"./assets/img/arrow.png",WALL:"./assets/img/wall.png",SMALL_BLOCK:"./assets/img/small_block.png",PLATFORM:"./assets/img/platform.png",MAP1:"./assets/map/map1.json",get:function(e){}}},{}],43:[function(e,t,i){"use strict";var s=e("./Assets.js"),o=function(e){this.queue=new createjs.LoadQueue(!1),this.queue.installPlugin(createjs.Sound),s.get=this.queue.getResult.bind(this.queue),e&&this.queue.on("complete",e);var t=[];for(var i in s){var o={id:i,src:s[i]};t.push(o)}this.queue.loadManifest(t)};t.exports=o},{"./Assets.js":42}],44:[function(e,t,i){"use strict";var s=wfl.geom.Vec2,o={seek:function(e,t){var i=s.subtract(t.position,e.position).normalize().multiply(e.maxSpeed),o=i.subtract(e.velocity);return o.limit(e.mass*e.maxAcceleration),o}};t.exports=o},{}],45:[function(e,t,i){"use strict";var s=e("./Assets.js"),o=e("./Preloader.js"),a=e("./Steer.js");t.exports={Assets:s,Preloader:o,Steer:a}},{"./Assets.js":42,"./Preloader.js":43,"./Steer.js":44}]},{},[11]);
